import{p as S,i as T,ad as w,s as I,t as $,u as G,v as U,ae as B,a as s,_ as D,o as h,h as f,w as l,e as j,V as g,L as V,b as d,d as v,f as b,c as A,N as E,O as F,a2 as k,ac as y,a5 as C}from"./index-5d579034.js";import{V as x}from"./VForm-1429d45b.js";import{V as P}from"./VRow-a5df2455.js";import{V as m}from"./VCol-2308291c.js";import{V as c}from"./VSelect-d87bab9f.js";import{V as N}from"./VAutocomplete-16caebc7.js";import{V as z}from"./VTextField-5ae99a31.js";import{V as L}from"./VContainer-e02257f0.js";import"./dialog-transition-a46b8347.js";import"./filter-0178f655.js";const M=Symbol.for("vuetify:v-item-group"),H=S({...T(),...w({selectedClass:"v-item--selected"}),...I(),...$()},"VItemGroup"),O=G()({name:"VItemGroup",props:H(),emits:{"update:modelValue":t=>!0},setup(t,e){let{slots:o}=e;const{themeClasses:a}=U(t),{isSelected:p,select:u,next:r,prev:n,selected:i}=B(t,M);return()=>s(t.tag,{class:["v-item-group",a.value,t.class],style:t.style},{default:()=>{var _;return[(_=o.default)==null?void 0:_.call(o,{isSelected:p,select:u,next:r,prev:n,selected:i.value})]}})}}),R={data:function(){return{pending_courses:[],completed_courses:[],current_courses:[],all_courses:[],current_degree_level:"",level_list:"",dp_ds:"both",max_courses:2}},methods:{save:async function(){this.completed_courses.length>0&&(this.completed_courses=this.completed_courses[0].id==""?[]:this.completed_courses);let t=sessionStorage.getItem("token");await fetch("/api/v1/profile",{method:"PATCH",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({maximum_courses_in_a_term:this.max_courses,current_degree_level:this.current_degree_level,dp_or_ds:this.dp_or_ds,current_courses:this.current_courses,completed_courses:this.completed_courses.map(e=>(e.marks=Number(e.marks),e))})}).then(e=>e.json().then(o=>({response:e,data:o}))).then(({response:e,data:o})=>{if(!e.ok)throw new Error(`Error ${e.status}: ${o.message}`);this.$router.push({name:"StudentHome"}),this.$root.vtoast.show({message:"Updated Profile"})}).catch(e=>{console.log(e),this.$root.vtoast.show({message:e.message,color:"error"})})},add(){this.completed_courses.push({id:"",marks:0})},remove(t){this.completed_courses.splice(t,1)},getCourseInfo:async function(t){let e=sessionStorage.getItem("token");return fetch("/api/v1/courses/"+t,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}).then(o=>o.json().then(a=>({response:o,data:a}))).then(({response:o,data:a})=>(console.log(t+" fetched"),a)).catch(o=>{throw console.log(o),Error(o)})},getProfile:async function(){let t=sessionStorage.getItem("token");await fetch("/api/v1/profile",{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}}).then(e=>e.json().then(o=>({response:e,data:o}))).then(({response:e,data:o})=>{sessionStorage.setItem("pic",o.pic),this.completed_courses=o.bio.completed_courses.length>0?o.bio.completed_courses:[{id:"",marks:0}],this.current_courses=o.bio.current_courses,this.current_degree_level=o.bio.current_degree_level,this.max_courses=o.bio.maximum_courses_in_a_term,console.log("Profile Data Fetched")}).catch(e=>{console.log(e)})},getAllcourses:async function(){let t=sessionStorage.getItem("token");return fetch("/api/v1/courses/all",{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}}).then(e=>e.json().then(o=>({response:e,data:o}))).then(({response:e,data:o})=>{this.all_courses=o,this.pending_courses=o,this.pending_courses=o.filter(a=>!this.completed_courses.map(u=>u.id).includes(a.id))}).catch(e=>{console.log(e)})}},mounted:async function(){this.getProfile(),this.getAllcourses()}};function J(t,e,o,a,p,u){return h(),f(L,null,{default:l(()=>[s(x,{"fast-fail":"",onSubmit:j(u.save,["prevent"])},{default:l(()=>[s(P,null,{default:l(()=>[s(m,{cols:"12",md:"6"},{default:l(()=>[s(g,null,{default:l(()=>[s(V,null,{default:l(()=>[d("User Profile")]),_:1}),s(v,null,{default:l(()=>[s(c,{items:[{id:"foundation",name:"Foundation"},{id:"diploma",name:"Diploma"},{id:"degree",name:"Degree"}],modelValue:t.current_degree_level,"onUpdate:modelValue":e[0]||(e[0]=r=>t.current_degree_level=r),label:"Current Degree Level","item-title":"name","item-value":"id"},null,8,["modelValue"]),s(c,{items:[{id:"dp",name:"Diploma in Programming"},{id:"ds",name:"Diploma in Data Science"},{id:"both",name:"Both"}],modelValue:t.dp_ds,"onUpdate:modelValue":e[1]||(e[1]=r=>t.dp_ds=r),"item-title":"name","item-value":"id",label:"Preferred Stream for Recommendations"},null,8,["modelValue"]),s(c,{modelValue:t.max_courses,"onUpdate:modelValue":e[2]||(e[2]=r=>t.max_courses=r),items:[2,3,4],label:"Maximum Courses",type:"number",class:"mb-5",hint:"Pick the maximum number of courses you wish to take in upcoming terms","persistent-hint":""},null,8,["modelValue"]),s(c,{items:t.all_courses,modelValue:t.current_courses,"onUpdate:modelValue":e[3]||(e[3]=r=>t.current_courses=r),"item-title":"name","item-value":"id",label:"Current Courses",multiple:"",hint:"Pick the courses in your current term","persistent-hint":""},null,8,["items","modelValue"]),s(b,{type:"submit",block:"",class:"mt-5",color:"primary"},{default:l(()=>[d("Submit")]),_:1})]),_:1})]),_:1})]),_:1}),s(m,{cols:"12",md:"6"},{default:l(()=>[s(g,null,{default:l(()=>[s(V,null,{default:l(()=>[d("Completed Course Details")]),_:1}),s(v,null,{default:l(()=>[(h(!0),A(E,null,F(t.completed_courses,(r,n)=>(h(),f(O,{key:n},{default:l(()=>[s(P,null,{default:l(()=>[s(m,{cols:"12",md:"9"},{default:l(()=>[s(N,{label:"Completed Course",items:t.pending_courses,modelValue:r.id,"onUpdate:modelValue":i=>r.id=i,"item-title":"name",class:"mb-2","item-value":"id",hint:"Pick the course you have completed, and its marks","persistent-hint":""},null,8,["items","modelValue","onUpdate:modelValue"])]),_:2},1024),s(m,{cols:"12",md:"2"},{default:l(()=>[s(z,{label:"Marks",modelValue:r.marks,"onUpdate:modelValue":i=>r.marks=i,type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),s(m,{cols:"12",md:"1"},{default:l(()=>[k(s(y,{icon:"mdi-delete",onClick:i=>u.remove(n)},null,8,["onClick"]),[[C,n||!n&&t.completed_courses.length>0]])]),_:2},1024)]),_:2},1024),k(s(y,{icon:"mdi-plus",onClick:i=>u.add(n)},null,8,["onClick"]),[[C,n==t.completed_courses.length-1]])]),_:2},1024))),128)),s(b,{type:"submit",block:"",class:"mt-5",color:"primary"},{default:l(()=>[d("Submit")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})}const se=D(R,[["render",J]]);export{se as default};
